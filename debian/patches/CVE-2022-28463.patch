From e6ea5876e0228165ee3abc6e959aa174cee06680 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Sat, 26 Mar 2022 09:27:36 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/4988

---
 coders/cin.c | 2 ++
 1 file changed, 2 insertions(+)

--- imagemagick-6.9.11.60+dfsg.orig/coders/cin.c
+++ imagemagick-6.9.11.60+dfsg/coders/cin.c
@@ -450,6 +450,8 @@ static Image *ReadCINImage(const ImageIn
   image->endian=(magick[0] == 0x80) && (magick[1] == 0x2a) &&
     (magick[2] == 0x5f) && (magick[3] == 0xd7) ? MSBEndian : LSBEndian;
   cin.file.image_offset=ReadBlobLong(image);
+  if (cin.file.image_offset < 712)
+    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
   offset+=4;
   cin.file.generic_length=ReadBlobLong(image);
   offset+=4;
